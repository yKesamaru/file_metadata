# ã‚¿ã‚°ä»˜ã‘ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’GUIã§å†å¸°çš„æ¤œç´¢ã™ã‚‹æ–¹æ³•

## ã¯ã˜ã‚ã«
`Ubuntu 22.04`ã§ã¯æ§˜ã€…ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚
ã“ã‚Œã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æ¯ã«ç•°ãªã‚‹åˆ©ç‚¹ãŒã‚ã‚‹ã“ã¨ã‹ã‚‰ã€ã‚ãŸã—ã¯ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’åŒæ™‚ã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚[^1]

[^1]: ãŸã¨ãˆã°`Nautilus`ã§ã¯å†å¸°çš„ãªãƒ•ã‚¡ã‚¤ãƒ«åã®æ¤œç´¢ãŒä¾¿åˆ©ã ã£ãŸã‚Šã€`pcmanfm-qt`ã§ã¯å†èµ·å‹•å¾Œã®ã‚¿ãƒ–ä»˜ãã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†è¡¨ç¤ºã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚`Thunar`ã§ã¯ãƒ•ã‚¡ã‚¤ãƒ«åã®ä¸€æ‹¬å¤‰æ›´ã«ä¾¿åˆ©ã§ã™ã€‚

ãã—ã¦ã“ã‚Œã‚‰ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¿ã‚°ä»˜ã‘ã§ãã¾ã™ã€‚ãã‚Œã‚‰ã¯
- `Nautilus`ï¼šã‚¹ã‚¿ãƒ¼
- `Thunar`ï¼šã‚·ãƒ³ãƒœãƒ«ï¼ˆã‚¨ãƒ³ãƒ–ãƒ¬ãƒ ï¼‰

ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã‚Œã‚‰ã‚’ä½¿ã£ãŸ**å†å¸°çš„ãªæ¤œç´¢è¡¨ç¤º**ã¯ã§ããªã„ã‚‚ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

çµè«–ã‹ã‚‰æ›¸ãã¨ã€`Nautilus`ã§ã¯ã‚¹ã‚¿ãƒ¼ã®ã¤ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢ã§ãã¾ã›ã‚“ã€‚ï¼ˆä¸€è¦§è¡¨ç¤ºã§ã‚¹ã‚¿ãƒ¼ã‚’è¡¨ç¤ºã•ã›ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã¨ã€ãã®ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸¦ã³é †ã‚’ã‚¹ã‚¿ãƒ¼ãŒã¤ã„ã¦ã„ã‚‹ã‚‚ã®ã‚’å…ˆé ­ã«ã™ã‚‹ã‚ˆã†ãªäº‹ã¯ã§ãã¾ã™ãŒã€å†å¸°çš„ã«æ¤œç´¢ã¯ã§ãã¾ã›ã‚“ï¼ˆã‚ãŸã—ã«ã¯ç„¡ç†ï¼‰ï¼‰

å¯¾ã—ã¦`Thunar`ã§ã¯ã‚·ãƒ³ãƒœãƒ«ã‚’ã¤ã‘ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å†å¸°çš„ãªæ¤œç´¢ãŒå¯èƒ½ã§ã™ã€‚

ã“ã“ã§ã¯èƒŒæ™¯æƒ…å ±ã¨ã¨ã‚‚ã«è¨˜äº‹ã¨ã—ã¦å…±æœ‰ã—ã¾ã™ã€‚

![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/eye-catch.png)

- [ã‚¿ã‚°ä»˜ã‘ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’GUIã§å†å¸°çš„æ¤œç´¢ã™ã‚‹æ–¹æ³•](#ã‚¿ã‚°ä»˜ã‘ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’guiã§å†å¸°çš„æ¤œç´¢ã™ã‚‹æ–¹æ³•)
  - [ã¯ã˜ã‚ã«](#ã¯ã˜ã‚ã«)
  - [ç’°å¢ƒ](#ç’°å¢ƒ)
  - [æ‹¡å¼µå±æ€§](#æ‹¡å¼µå±æ€§)
  - [æ‹¡å¼µå±æ€§ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•](#æ‹¡å¼µå±æ€§ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•)
    - [æ¤œç´¢ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](#æ¤œç´¢ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ)
    - [`Thunar`ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ç™»éŒ²ã™ã‚‹](#thunarã®ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ç™»éŒ²ã™ã‚‹)
  - [æ³¨æ„ç‚¹](#æ³¨æ„ç‚¹)
  - [ãŠã‚ã‚Šã«](#ãŠã‚ã‚Šã«)
  - [å‚è€ƒæ–‡çŒ®](#å‚è€ƒæ–‡çŒ®)

## ç’°å¢ƒ
```bash
inxi -Sxxx --filter
System:
  Kernel: 6.5.0-45-generic x86_64 bits: 64 compiler: N/A Desktop: Unity
    wm: gnome-shell dm: GDM3 42.0 Distro: Ubuntu 22.04.4 LTS (Jammy Jellyfish)
```

## æ‹¡å¼µå±æ€§
æ‹¡å¼µå±æ€§ï¼ˆ`xattr`ï¼‰ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†ä»•çµ„ã¿ã§ã™ã€‚ã“ã‚Œã‚‰ã¯é€šå¸¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿ã¨ã¯åˆ¥ã«ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ æƒ…å ±ã‚’ä»˜åŠ ã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

ä¾‹ãˆã°`mime`ã‚¿ã‚¤ãƒ—ã‚„ã‚¹ã‚¿ãƒ¼ã«ã‚ˆã‚‹ã‚¿ã‚°ä»˜ã‘ãªã©ã§ã™ã€‚

`Linux`ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã¯ã€æ§˜ã€…ãªæ‹¡å¼µå±æ€§ã‚’åˆ©ç”¨ã—ãŸä¾¿åˆ©æ©Ÿèƒ½ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ä¾¿åˆ©æ©Ÿèƒ½ã‚’æ”¯ãˆã‚‹ä»•çµ„ã¿ã¯`XDG`ã®ã‚ˆã†ã«æ±ç”¨æ€§ã®é«˜ã„ã‚‚ã®ã‹ã‚‰`GVfs`ã®ã‚ˆã†ã«ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ç’°å¢ƒã«ã‚ˆã‚‹ã‚‚ã®ã¾ã§æ§˜ã€…ã§ã™ã€‚[^3]

[^3]: `GNOME`ã®å ´åˆã¯`GIO`ã€`KDE`ã®å ´åˆã¯`KIO`ã€`Enlightenment`ã®å ´åˆã¯`EIO`ãªã©ã€ã‚ã¨ã¯`FUSE`ã¨ã‹æ§˜ã€…ã§ã™ã€‚åŸºæœ¬çš„ã«ã¯`ext4`ãªã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒæ‹¡å¼µå±æ€§ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚Œã°åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»Šå›ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¿ã‚°ä»˜ã‘ã™ã‚‹æ©Ÿèƒ½ã€ãŸã¨ãˆã°`Nautilus`ã®ã‚¹ã‚¿ãƒ¼ã¨ã‹`Thunar`ã®ã‚·ãƒ³ãƒœãƒ«ã«ã¤ã„ã¦æ‰±ã„ã¾ã™ã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

1. `Nautilus`ã§ã®ã‚¹ã‚¿ãƒ¼
ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º
![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/2024-08-13-13-43-48.png)
ä¸€è¦§è¡¨ç¤º
![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/2024-08-13-13-44-27.png)

2. `Thunar`ã§ã®ã‚·ãƒ³ãƒœãƒ«
![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/2024-08-13-13-12-20.png)

ã‚ãŸã—ã¯ã“ã®ã‚ˆã†ãªã‚¿ã‚°ä»˜ã‘ã‚’ã‚ã¾ã‚Šåˆ©ç”¨ã—ã¦ã„ãªã‹ã£ãŸã®ã§ã™ãŒã€**ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½ç½®ï¼ˆãƒ‘ã‚¹ï¼‰ã‚’ç§»å‹•ã—ã¦ã‚‚ã“ã®ã‚¿ã‚°ä»˜ã‘ãŒæ¶ˆãˆãªã„**ã“ã¨ã«æ°—ã¥ãã€ã“ã‚Œã¯ä¾¿åˆ©ã ãªã€ã¨æ€ã„ã¾ã—ãŸã€‚ã©ã†ã‚„ã‚‰`inode`ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã®ã‚ˆã†ã§ã™ã€‚

ã“ã‚Œã‚‰ã‚¹ã‚¿ãƒ¼ã‚„ã‚·ãƒ³ãƒœãƒ«ã‚’ã¤ã‘ãŸãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã‚’å†å¸°çš„ã«ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§è¡¨ç¤ºã•ã›ã‚‹ã‚ˆã†ãªæ©Ÿèƒ½ãŒã‚ã£ãŸã‚‰ä¾¿åˆ©ã§ã™ã‚ˆã­ï¼Ÿ

ãŸã ç¾çŠ¶ã§ã¯`Nautilus`ã€`Thunar`ã®ä¸¡è€…ã¨ã‚‚ã“ã®ã‚ˆã†ãªæ¤œç´¢æ©Ÿèƒ½ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

## æ‹¡å¼µå±æ€§ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
ç„¡ã„æ©Ÿèƒ½ã¯ä½œã‚‹ã€ã§ä¸‹èª¿ã¹ã—ã¦ã¿ã¾ã—ãŸã€‚
ã“ã‚Œã‚‰ã®æ‹¡å¼µå±æ€§ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•ãŒãªã‘ã‚Œã°ã©ã†ã«ã‚‚ãªã‚Šã¾ã›ã‚“ã€‚

ã¾ãš`Nautilus`ã®ã‚¹ã‚¿ãƒ¼ã«ã¤ã„ã¦èª¿æŸ»ã—ã¾ã™ã€‚

ã„ãã¤ã‹èª¿ã¹ã¦ã¿ã¾ã—ãŸãŒã€`gio`ã‚³ãƒãƒ³ãƒ‰ã‚„`xattr`ã‚³ãƒãƒ³ãƒ‰ã€ã‚ã‚‹ã„ã¯`attr`ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§å¾—ã‚‰ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼ˆ`getfattr`ã‚³ãƒãƒ³ãƒ‰ãªã©ï¼‰ã§ã¯ã‚¹ã‚¿ãƒ¼ï¼ˆ`Nautilus`ï¼‰ã«ã¤ã„ã¦ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚

`gvfs-info`ã‚³ãƒãƒ³ãƒ‰ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã¨ã®è¨˜è¿°ã‚’è¦‹ã¤ã‘ã¾ã—ãŸãŒã€`Ubuntu 22.04`ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚`gvfs-metadata`ã‚³ãƒãƒ³ãƒ‰ã‚‚å­˜åœ¨ã—ã¾ã›ã‚“ã€‚(universe, multiverseå«ã‚€)

`Nautilus`ã«ãŠã‘ã‚‹ã‚¹ã‚¿ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã¯`GVFS`ã«ã‚ˆã£ã¦`metadata::emblems`åå‰ç©ºé–“ã«æ ¼ç´ã€ãã‚Œã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¯`~/.local/share/gvfs-metadata/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã«ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

å‚è€ƒï¼š
- [GNOME: Where does Nautilus store emblem data and how?](https://stackoverflow.com/questions/10874702/gnome-where-does-nautilus-store-emblem-data-and-how)
- [GVFSD-METADATA(1)](https://man.archlinux.org/man/gvfsd-metadata.1.en)
- [æ‹¡å¼µå±æ€§](https://wiki.archlinux.jp/index.php/%E6%8B%A1%E5%BC%B5%E5%B1%9E%E6%80%A7)
- [xattr(7)](https://man.archlinux.org/man/xattr.7)

`Nautilus`ã§ã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤šæ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨æ¯”è¼ƒã—ã¦ã‹ãªã‚Šå‹•ä½œãŒé‡ããªã‚Šã¾ã™ãŒã€ã“ã®åŸå› ãŒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆæ‹¡å¼µå±æ€§ï¼‰ã®å‡¦ç†ã«ã‚ˆã‚‹ã‚‚ã®ãªã®ã‹ã‚‚ã—ã‚Œãªã„ãªâ€¦ã¨æ€ã„ã¾ã—ãŸã€‚

å‚è€ƒï¼š
- [Nautilus FAQ Slow Nautilus](https://wiki.debian.org/Nautilus/FAQ/SlowNautilus)


`tracker3`ã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€ã¨ã„ã†æƒ…å ±ãŒã‚ã£ãŸã®ã§ã€`tracker-test-utils`ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦`tracker3`ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨å¯èƒ½ã«ã—ã¾ã—ãŸã€‚

`tracker3 info star.png`ã¨ã™ã‚‹ã¨ã€å¾Œè¿°ã™ã‚‹`gio info star.png`ã¨åŒã˜ã‚ˆã†ã«è©³ç´°ãªæƒ…å ±ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã—ã‹ã—ã“ã®ä¸­ã«ã€Œã‚¹ã‚¿ãƒ¼ãŒã¤ã„ã¦ã„ã‚‹ã‹ã©ã†ã‹ã€ã‚’è¡¨ã™æƒ…å ±ã¯å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚

```bash
user@user:~/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ/file_metadata/assets$ tracker3 info star.png | xsel
Querying information for entity: 'star.png'
  'file:///home/user/%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88/file_metadata/assets/star.png'
Results:
  'tracker:extractorHash' = 'b87eb36f02de830b63f91cc53c1a6db2b1b167622a4380961eb6775f90126cd6'
  'nfo:fileLastModified' = '2024-08-13T04:09:42Z'
  'nfo:fileName' = 'star.png'
  'nfo:fileSize' = '300323'
  'nfo:belongsToContainer' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:35270024'
  'nfo:fileCreated' = '2024-08-13T04:09:42Z'
  'nfo:fileLastAccessed' = '2024-08-13T04:09:42Z'
  'nie:isPartOf' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:6433807'
  'nie:isPartOf' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:35270017'
  'nie:isPartOf' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:35270024'
  'nie:created' = '2024-08-13T04:09:42Z'
  'nie:interpretedAs' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:6459418'
  'nie:dataSource' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:5767264'
  'nie:byteSize' = '300323'
  'nie:url' = 'file:///home/user/%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88/file_metadata/assets/star.png'
  'http://purl.org/dc/elements/1.1/source' = 'urn:fileid:03d690db-6073-4ac2-a67d-d90c69aab9a7:5767264'
  'http://purl.org/dc/elements/1.1/date' = '2024-08-13T04:09:42Z'
  'nrl:modified' = '54'
  'nrl:added' = '2024-08-13T04:39:12Z'
  'rdf:type' = 'http://www.w3.org/2000/01/rdf-schema#Resource'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nie#DataObject'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nfo#FileDataObject'
  'nmm:dlnaMime' = 'image/png'
  'nmm:dlnaProfile' = 'PNG_LRG'
  'nfo:width' = '533'
  'nfo:height' = '493'
  'nie:isStoredAs' = 'file:///home/user/%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88/file_metadata/assets/star.png'
  'nie:mimeType' = 'image/png'
  'nrl:modified' = '54'
  'nrl:added' = '2024-08-13T04:09:43Z'
  'rdf:type' = 'http://www.w3.org/2000/01/rdf-schema#Resource'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nie#InformationElement'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nfo#Media'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nfo#Visual'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nfo#Image'
  'rdf:type' = 'http://tracker.api.gnome.org/ontology/v3/nmm#Photo'
```

`tracker3 sparql`ã‚’ä½¿ãˆã°ã€ã‚ã‚‹ã„ã¯ã‚¹ã‚¿ãƒ¼ãŒã¤ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œç´¢ã§ãã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ã‚ãŸã—ã®èƒ½åŠ›ã‚’è¶…ãˆã‚‹ã®ã§ã“ã‚Œä»¥ä¸Šã¯èª¿ã¹ã¾ã›ã‚“ã§ã—ãŸã€‚ã§ã™ã®ã§`Nautilus`ã®ã‚¹ã‚¿ãƒ¼ã‚’ç”¨ã„ãŸå†å¸°çš„æ¤œç´¢ã¯è«¦ã‚ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

å‚è€ƒï¼š
- [TRACKER3-SPARQL(1)](https://man.archlinux.org/man/tracker3-sparql.1.en)


ã•ã¦ã€`Nautilus`ã®ã‚¹ã‚¿ãƒ¼ã«é–¢ã™ã‚‹å±æ€§æƒ…å ±ã®ã‚¢ã‚¯ã‚»ã‚¹ã®ã—ã«ãã•ã¨å¯¾è±¡çš„ã«ã€`Thunar`ã«ãŠã‘ã‚‹ã‚·ãƒ³ãƒœãƒ«ã®å±æ€§æƒ…å ±ã«ã¤ã„ã¦ã¯`gio info`ã‚³ãƒãƒ³ãƒ‰ã§ç°¡å˜ã«ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```bash
user@user:~/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ/file_metadata/assets$ gio info star.png | xsel

è¡¨ç¤ºå: star.png
ç·¨é›†å: star.png
åå‰: star.png
ç¨®é¡: regular
ã‚µã‚¤ã‚º:  300323
URI: file:///home/user/%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88/file_metadata/assets/star.png
ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹: /home/user/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ/file_metadata/assets/star.png
unix mount: /dev/nvme0n1p2 / ext4 rw,relatime,errors=remount-ro
å±æ€§:
  standard::type: 1
  standard::name: star.png
  standard::display-name: star.png
  standard::edit-name: star.png
  standard::copy-name: star.png
  standard::icon: image-png, image-x-generic, image-png-symbolic, image-x-generic-symbolic
  standard::content-type: image/png
  standard::fast-content-type: image/png
  standard::size: 300323
  standard::allocated-size: 303104
  standard::symbolic-icon: image-png-symbolic, image-x-generic-symbolic, image-png, image-x-generic
  etag::value: 1723522182:927808
  id::file: l66306:6459418
  id::filesystem: l66306
  access::can-read: TRUE
  access::can-write: TRUE
  access::can-execute: FALSE
  access::can-delete: TRUE
  access::can-trash: TRUE
  access::can-rename: TRUE
  time::modified: 1723522182
  time::modified-usec: 927808
  time::access: 1723523952
  time::access-usec: 666366
  time::changed: 1723523952
  time::changed-usec: 646366
  time::created: 1723522182
  time::created-usec: 815809
  unix::device: 66306
  unix::inode: 6459418
  unix::mode: 33204
  unix::nlink: 1
  unix::uid: 1000
  unix::gid: 1000
  unix::rdev: 0
  unix::block-size: 4096
  unix::blocks: 592
  owner::user: user
  owner::user-real: user
  owner::group: user
  thumbnail::path: /home/user/.cache/thumbnails/large/3f745d67dd3076c941d85afd04133e8d.png
  thumbnail::is-valid: TRUE
  metadata::emblems: [emblem-cool]    # <- ã“ã‚Œã€‚
```

ã“ã®æƒ…å ±ã‚’ä½¿ã£ã¦ã€`metadata::emblems`ã«æƒ…å ±ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚„ã£ãŸãƒğŸ˜ƒ

### æ¤œç´¢ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å†å¸°çš„ã«æœæŸ»ã—ã€ã‚·ãƒ³ãƒœãƒ«ã‚’ã¤ã‘ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå–å¾—ã§ãã‚‹ã‹ã©ã†ã‹ã®ãƒ†ã‚¹ãƒˆã®ãŸã‚ã€ä»¥ä¸‹ã®ç°¡å˜ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```bash
#!/bin/bash

# æ¤œç´¢ã‚’é–‹å§‹ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®š
DIRECTORY=${1:-.}

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å†å¸°çš„ã«æ¤œç´¢ã—ã€metadata::emblemsãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º
find "$DIRECTORY" -type f | while read -r file; do
    if gio info -a "metadata::emblems" "$file" | grep -q "metadata::emblems"; then
        echo "$file"
    fi
done
```

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚·ãƒ³ãƒœãƒ«ã‚’ã¤ã‘ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†å¸°çš„ã«æœæŸ»ã—ãƒªã‚¹ãƒˆã‚’å–å¾—ã§ãã¾ã—ãŸã€‚

```bash
# ä½¿ã„æ–¹
user@user:~/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ/file_metadata$ ./metadata.sh ./
assets/star.png

```

### `Thunar`ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ç™»éŒ²ã™ã‚‹
å…ˆç¨‹ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿé¨“æˆåŠŸã—ãŸã®ã§ã€ä»Šåº¦ã¯`Thunar`ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«é©åˆã™ã‚‹ã‚ˆã†ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ”¹å¤‰ã—ã¾ã™ã€‚

```bash: find_emblem_files_thunar.sh
#!/bin/bash

# æ¤œç´¢ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆThunarã‹ã‚‰%fã¨ã—ã¦æ¸¡ã•ã‚Œã‚‹ï¼‰
DIRECTORY="$1"

# ä¸€æ™‚çš„ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ã€æ¤œç´¢çµæœã‚’ä¿å­˜
TEMP_DIR=$(mktemp -d)

# ã‚·ãƒ³ãƒœãƒ«ãŒä»˜ã‘ã‚‰ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢ã—ã€çµæœã‚’ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã¨ã—ã¦ä¿å­˜
find "$DIRECTORY" -type f | while read -r file; do
    if gio info -a "metadata::emblems" "$file" | grep -q "metadata::emblems"; then
        ln -s "$file" "$TEMP_DIR/$(basename "$file")"
    fi
done

# Thunarã§æ¤œç´¢çµæœã‚’è¡¨ç¤º
thunar "$TEMP_DIR"

```

ã“ã®ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã€ã“ã‚Œã‚’ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ç™»éŒ²ã—ã¾ã™ã€‚
- ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ç™»éŒ²
![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/2024-08-13-16-21-15.png)
- ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å‡ºç¾æ¡ä»¶ã‚’è¨­å®š
![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/2024-08-13-16-21-51.png)

- å®Ÿè¡Œçµæœ
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚
æ–°ã—ãã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã€æ¤œç´¢çµæœãŒ(GUIã§)è¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼
![](https://raw.githubusercontent.com/yKesamaru/file_metadata/master/assets/2024-08-13-16-23-07.png)

æˆåŠŸã§ã™ã€‚

## æ³¨æ„ç‚¹
ä¸‹èª¿ã¹ä¸­ã«çŸ¥ã£ãŸã®ã§ã™ãŒã€æ‹¡å¼µå±æ€§ãŒã¤ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’`cp`ã—ãŸã‚Š`rsync`ã—ãŸã‚Šã™ã‚‹å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ä¿æŒã•ã‚Œãªã„å ´åˆãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

ä¸‹ã®è¡¨ã¯ã€ArchWiKiã®æ‹¡å¼µå±æ€§ã®é …ã‹ã‚‰è»¢è¼‰ã—ãŸã‚‚ã®ã§ã™ã€‚

| ã‚³ãƒãƒ³ãƒ‰     | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä¿æŒã™ã‚‹ã‹/å¿…è¦ãªãƒ•ãƒ©ã‚°                        |
|--------------|---------------------------------------------------------|
| `cp`         | `--archive` / `--preserve=all` / `--preserve=xattr`      |
| `mv`         | Yes[^2]                                          |
| `tar`        | ä½œæˆæ™‚ã«ã¯ `--xattrs`ã€å±•é–‹æ™‚ã«ã¯ `--xattrs-include='*'`  |
| `bsdtar`     | å±•é–‹æ™‚ã« `-p`                                            |
| `rsync`      | `-X`, `--xattrs`                                         |
| `cpio`       | No                                                       |
| `gzip`       | No                                                       |
| `pax`        | No                                                       |
| `syncthing`  | `syncXattrs` ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ã‚ã‚Š                        |

[^2]: ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•æ™‚ã€æ‹¡å¼µå±æ€§ã¯ä¿æŒã•ã‚Œã¾ã™ã€‚

ã‚ãŸã—ã¯`rsync`ã‚’ä½¿ã£ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ã¨ã£ã¦ã„ã¾ã™ãŒã€`--xattrs`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ãªã‘ã‚Œã°ã‚·ãƒ³ãƒœãƒ«ã®æƒ…å ±ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã†ã‚ˆã†ã§ã™ã€‚ï¼ˆæœªæ¤œè¨¼ï¼‰


## ãŠã‚ã‚Šã«
ã‚¹ã‚¿ãƒ¼ã‚„ã‚·ãƒ³ãƒœãƒ«å‘¨ã‚Šã®å‘¨è¾ºæƒ…å ±ãŒæ‰‹ã«å…¥ã‚Šã¾ã—ãŸã—ã€çµæœçš„ã«ä¾¿åˆ©æ©Ÿèƒ½ãŒã²ã¨ã¤ãµãˆã¾ã—ãŸã€‚
ã‚ˆã‚ã—ã‹ã£ãŸã‚‰ã”å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

## å‚è€ƒæ–‡çŒ®
- [GNOME: Where does Nautilus store emblem data and how?](https://stackoverflow.com/questions/10874702/gnome-where-does-nautilus-store-emblem-data-and-how)
- [GVFSD-METADATA(1)](https://man.archlinux.org/man/gvfsd-metadata.1.en)
- [æ‹¡å¼µå±æ€§](https://wiki.archlinux.jp/index.php/%E6%8B%A1%E5%BC%B5%E5%B1%9E%E6%80%A7)
- [xattr(7)](https://man.archlinux.org/man/xattr.7)
- [Nautilus FAQ Slow Nautilus](https://wiki.debian.org/Nautilus/FAQ/SlowNautilus)
- [TRACKER3-SPARQL(1)](https://man.archlinux.org/man/tracker3-sparql.1.en)

